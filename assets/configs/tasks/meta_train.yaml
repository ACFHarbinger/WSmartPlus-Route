# @package _global_

# General Configuration
verbose: true
seed: 42
start: 0

# Environment
env:
  name: "cwcvrp"
  distance_method: "gmaps"

# Meta-RL Settings
meta_rl:
  use_meta: true
  meta_strategy: "hrl" # meta_method
  meta_lr: 0.000005
  meta_hidden_dim: 128
  meta_history_length: 10
  mrl_batch_size: 256
  mrl_step: 10

  # HRL Parameters
  hrl_epochs: 2
  hrl_clip_eps: 0.2
  hrl_threshold: 0.9
  hrl_pid_target: 0.0003
  hrl_lambda_waste: 300.0
  hrl_lambda_cost: 0.5
  hrl_lambda_overflow_initial: 2000.0
  hrl_lambda_overflow_min: 100.0
  hrl_lambda_overflow_max: 5000.0
  hrl_lambda_pruning: 0.5
  hrl_lambda_must_go_aux: 5.0  # Weight for auxiliary must-go loss (supervised signal)
  hrl_entropy_coef: 0.01

# Optimization Overrides
optim:
  optimizer: "rmsprop"
  lr: 0.000005
  lr_decay: 1.0
  lr_scheduler: "lambda"

# RL Settings
rl:
  algorithm: "reinforce"
  baseline: "exponential"
  bl_alpha: 0.05
  exp_beta: 0.8
  max_grad_norm: 1.0

# Model Settings
model:
  name: "am"
  encoder_type: "gat"
  hidden_dim: 128

# Training
train:
  batch_size: 256
  val_data_size: 0
  eval_batch_size: 0
  log_step: 10

# Data Configuration
data:
  dataset_size: 1280
  data_distributions: ["gamma1"]
  graph_sizes: [100]

# Must-Go Selection Strategy
# When meta_strategy=hrl, the HRL manager learns to select must-go bins.
# Set strategy: null to let the manager control selection entirely.
# Alternatively, set a strategy to provide supervision signal for auxiliary loss.
must_go:
  strategy: null  # HRL manager learns must-go selection; set to "service_level" for supervised target
  # Parameters below are used if strategy is not null (for auxiliary supervision)
  # LastMinute parameters
  threshold: 0.7  # Fill level threshold (0-1)
  # Regular parameters
  frequency: 3  # Collection frequency in days
  # Lookahead parameters
  lookahead_days: 7  # Days to look ahead for overflow prediction
  # ServiceLevel parameters
  confidence_factor: 0.84  # Standard deviations for statistical prediction
  # Revenue parameters
  revenue_kg: 1.0  # Revenue per kg
  bin_capacity: 1.0  # Bin capacity
  revenue_threshold: 0.0  # Minimum revenue threshold
  # Common parameters
  max_fill: 1.0  # Overflow threshold

# Flags
wandb_mode: "disabled"
